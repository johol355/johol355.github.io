<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.306">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2024-01-30">

<title>Neurocritical care transfers: Analysis plan</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="1-descriptive-statistics_files/libs/clipboard/clipboard.min.js"></script>
<script src="1-descriptive-statistics_files/libs/quarto-html/quarto.js"></script>
<script src="1-descriptive-statistics_files/libs/quarto-html/popper.min.js"></script>
<script src="1-descriptive-statistics_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="1-descriptive-statistics_files/libs/quarto-html/anchor.min.js"></script>
<link href="1-descriptive-statistics_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="1-descriptive-statistics_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="1-descriptive-statistics_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="1-descriptive-statistics_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="1-descriptive-statistics_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#patient-selection" id="toc-patient-selection" class="nav-link active" data-scroll-target="#patient-selection">Patient Selection</a>
  <ul class="collapse">
  <li><a href="#general-inclusion-criteria-for-hospital-admissions" id="toc-general-inclusion-criteria-for-hospital-admissions" class="nav-link" data-scroll-target="#general-inclusion-criteria-for-hospital-admissions">General inclusion criteria for hospital admissions:</a></li>
  </ul></li>
  <li><a href="#major-issues-to-respond-to" id="toc-major-issues-to-respond-to" class="nav-link" data-scroll-target="#major-issues-to-respond-to">Major issues to respond to</a>
  <ul class="collapse">
  <li><a href="#limiting-selection-to-transfers-50-km" id="toc-limiting-selection-to-transfers-50-km" class="nav-link" data-scroll-target="#limiting-selection-to-transfers-50-km">Limiting selection to transfers &gt;50 km?</a></li>
  <li><a href="#limiting-selection-to-urgent-transfers-validity-of-sir-recordings-of-pre-transfer-status" id="toc-limiting-selection-to-urgent-transfers-validity-of-sir-recordings-of-pre-transfer-status" class="nav-link" data-scroll-target="#limiting-selection-to-urgent-transfers-validity-of-sir-recordings-of-pre-transfer-status">Limiting selection to “urgent transfers”? (Validity of SIR recordings of pre-transfer status)</a></li>
  <li><a href="#rls-85-vs-gcs" id="toc-rls-85-vs-gcs" class="nav-link" data-scroll-target="#rls-85-vs-gcs">RLS-85 vs GCS</a></li>
  <li><a href="#re-transfers" id="toc-re-transfers" class="nav-link" data-scroll-target="#re-transfers">Re-transfers</a></li>
  </ul></li>
  <li><a href="#descriptive-statistics" id="toc-descriptive-statistics" class="nav-link" data-scroll-target="#descriptive-statistics">Descriptive statistics</a>
  <ul class="collapse">
  <li><a href="#cohort-description" id="toc-cohort-description" class="nav-link" data-scroll-target="#cohort-description">Cohort description</a></li>
  <li><a href="#sending-hospital-description" id="toc-sending-hospital-description" class="nav-link" data-scroll-target="#sending-hospital-description">Sending Hospital Description</a></li>
  <li><a href="#receiving-hospital-description" id="toc-receiving-hospital-description" class="nav-link" data-scroll-target="#receiving-hospital-description">Receiving Hospital Description</a></li>
  </ul></li>
  <li><a href="#statistical-inference" id="toc-statistical-inference" class="nav-link" data-scroll-target="#statistical-inference">Statistical Inference</a>
  <ul class="collapse">
  <li><a href="#are-there-differences-in-outcomes-per-tertiary-center-in-these-transferred-patients" id="toc-are-there-differences-in-outcomes-per-tertiary-center-in-these-transferred-patients" class="nav-link" data-scroll-target="#are-there-differences-in-outcomes-per-tertiary-center-in-these-transferred-patients">Are there differences in outcomes per tertiary center in these transferred patients?</a></li>
  <li><a href="#what-are-the-predictors-for-short-term-mortality-in-transferred-patients" id="toc-what-are-the-predictors-for-short-term-mortality-in-transferred-patients" class="nav-link" data-scroll-target="#what-are-the-predictors-for-short-term-mortality-in-transferred-patients">What are the predictors for short term mortality in transferred patients?</a></li>
  <li><a href="#what-is-the-effect-of-transfer-distance-on-outcome" id="toc-what-is-the-effect-of-transfer-distance-on-outcome" class="nav-link" data-scroll-target="#what-is-the-effect-of-transfer-distance-on-outcome">What is the effect of transfer distance on outcome?</a></li>
  <li><a href="#what-is-the-effect-of-season-and-weather-flight-rules-at-time-of-primary-icu-discharge-on-outcome-in-patients-transferred-from-hospitals-utilizing-rotary-wing-transports" id="toc-what-is-the-effect-of-season-and-weather-flight-rules-at-time-of-primary-icu-discharge-on-outcome-in-patients-transferred-from-hospitals-utilizing-rotary-wing-transports" class="nav-link" data-scroll-target="#what-is-the-effect-of-season-and-weather-flight-rules-at-time-of-primary-icu-discharge-on-outcome-in-patients-transferred-from-hospitals-utilizing-rotary-wing-transports">What is the effect of season and weather (flight rules at time of primary ICU discharge) on outcome in patients transferred from hospitals utilizing rotary wing transports?</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Neurocritical care transfers: Analysis plan</h1>
<p class="subtitle lead">Descriptive statistics and inferential models</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Johan Olsson </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">January 30, 2024</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="patient-selection" class="level2">
<h2 class="anchored" data-anchor-id="patient-selection">Patient Selection</h2>
<section id="general-inclusion-criteria-for-hospital-admissions" class="level3">
<h3 class="anchored" data-anchor-id="general-inclusion-criteria-for-hospital-admissions">General inclusion criteria for hospital admissions:</h3>
<ol type="1">
<li><p>Patient age &gt;= 18 at admission</p></li>
<li><p>Admission date on or later than January 1st 2010</p></li>
<li><p>Admission to one of the six tertiary centers in Sweden ### Diagnosis group specific criteria for hospital admissions: #### Aneurysmal SAH (aSAH)</p></li>
<li><p>A primary diagnosis of I60.X (aSAH) OR a KVÅ code indicative of aneurysm clipping (AAC00) or endovascular coiling (AAL00)</p>
<p><strong>AND</strong></p></li>
<li><p>If point 1 is true, the admission must also NOT have a primary diagnosis of I671 (unruptured aneurysm) AND NOT asecondary diagnosis of Q28.X (AVM) or S06.X (TBI).</p>
<p><strong>OR</strong></p></li>
<li><p>If the criteria in 1. + 2. are not fulfilled, the admission can be included if the patient dies within 30 days and the death is registered within the Swedish Death Registry with a main cause of death being I60.X (aSAH) AND 2. is true.</p></li>
</ol>
<section id="traumatic-brain-injury-tbi" class="level4">
<h4 class="anchored" data-anchor-id="traumatic-brain-injury-tbi">Traumatic Brain Injury (TBI)</h4>
<ol type="1">
<li><p>A primary diagnosis of S06.X (TBI)</p>
<p><strong>OR</strong></p></li>
<li><p>A secondary diagnosis of S06.X (TBI) AND a primary diagnosis of either S02.0 (fracture of vault of skull ), S02.1 (basilar skull fracture), S02.8 (fractures of other specified skull and facial bones), S02.9 (fracture of skull and facial bones, part unspecified), S07.1 (crushing injury of skull), S04.X (injury of cranial nerve).</p></li>
</ol>
</section>
<section id="intracranial-hemorrhage-ich" class="level4">
<h4 class="anchored" data-anchor-id="intracranial-hemorrhage-ich">Intracranial Hemorrhage (ICH)</h4>
<ol type="1">
<li>A primary diagnosis of I61.X (ICH)</li>
</ol>
</section>
<section id="acute-ischemic-stroke-ais" class="level4">
<h4 class="anchored" data-anchor-id="acute-ischemic-stroke-ais">Acute Ischemic Stroke (AIS)</h4>
<ol type="1">
<li>A primary diagnosis of I63.X (ischemic stroke) excluding primary diagnosis of I63.6 (infarction caused by CVT)</li>
</ol>
</section>
<section id="acute-bacterial-meningitis-abm" class="level4">
<h4 class="anchored" data-anchor-id="acute-bacterial-meningitis-abm">Acute Bacterial Meningitis (ABM)</h4>
<ol type="1">
<li>A primary diagnosis of G00.X (bacterial meningitis) OR A39.0 (meningococcal meningitis).</li>
</ol>
</section>
<section id="status-epilepticus-sep" class="level4">
<h4 class="anchored" data-anchor-id="status-epilepticus-sep">Status Epilepticus (SEP)</h4>
<ol type="1">
<li>A primary diagnosis of G41.X</li>
</ol>
</section>
<section id="encephalitis-enc" class="level4">
<h4 class="anchored" data-anchor-id="encephalitis-enc">Encephalitis (ENC)</h4>
<ol type="1">
<li>A primary diagnosis of any of G04.X, G05.X, B00.4, B02.0, A841.</li>
</ol>
</section>
<section id="cerebral-venous-thrombosis-cvt" class="level4">
<h4 class="anchored" data-anchor-id="cerebral-venous-thrombosis-cvt">Cerebral Venous Thrombosis (CVT)</h4>
<ol type="1">
<li>A primary dianosis of any of G08.X (intracranial and intraspinal phlebitis and thrombophlebitis), I67.6 (non-pyogenic thrombosis of intracranial venous system), I63.6 (cerebral infarction due to cerebral venous thrombosis, non-pyogenic), O22.5 (cerebral venous thrombosis in pregnancy) and O87.3 (cerebral venous thrombosis in the puerperium).</li>
</ol>
</section>
<section id="arteriovenous-malformation-avm" class="level4">
<h4 class="anchored" data-anchor-id="arteriovenous-malformation-avm">Arteriovenous Malformation (AVM)</h4>
<ol type="1">
<li>A primary diagnosis of Q28.X</li>
</ol>
</section>
<section id="tie-breakers" class="level4">
<h4 class="anchored" data-anchor-id="tie-breakers">Tie Breakers</h4>
<ol type="1">
<li>In cases when several admissions for a given patient fulfill the inclusion criteria: choose the first of these admissions.</li>
<li>In cases when an admission fulfills several diagnostic criteria (typically both aSAH and ICH criteria): assume aSAH is the correct diagnosis.</li>
</ol>
</section>
<section id="flowchart" class="level4">
<h4 class="anchored" data-anchor-id="flowchart">Flowchart</h4>
<div class="cell" data-execution_count="1">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> graphviz</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> graphviz <span class="im">import</span> Digraph</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Variable assignments for node labels</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>node_label_1 <span class="op">=</span> <span class="st">'VTF i PAR (n=359305)'</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>node_label_2 <span class="op">=</span> <span class="st">'VTF vid tert. sjukh. med dx:</span><span class="ch">\n</span><span class="st"> aSAH (n=4891) </span><span class="ch">\n</span><span class="st"> TBI (n=6296 </span><span class="ch">\n</span><span class="st"> ICH (n=3509) </span><span class="ch">\n</span><span class="st"> AIS (n=3017) </span><span class="ch">\n</span><span class="st"> ABM (n=608) </span><span class="ch">\n</span><span class="st"> SEP (n=432) </span><span class="ch">\n</span><span class="st"> AVM (n=395) </span><span class="ch">\n</span><span class="st"> ENC (n=226) </span><span class="ch">\n</span><span class="st"> CVT (n=120) </span><span class="ch">\n</span><span class="st"> (VTF n=19494)'</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>node_label_3 <span class="op">=</span> <span class="st">'VTF vid tert. sjukh. med dx:</span><span class="ch">\n</span><span class="st"> aSAH (n=4819) </span><span class="ch">\n</span><span class="st"> TBI (n=6172 </span><span class="ch">\n</span><span class="st"> ICH (n=3294) </span><span class="ch">\n</span><span class="st"> AIS (n=2886) </span><span class="ch">\n</span><span class="st"> ABM (n=585) </span><span class="ch">\n</span><span class="st"> SEP (n=342) </span><span class="ch">\n</span><span class="st"> AVM (n=214) </span><span class="ch">\n</span><span class="st"> ENC (n=213) </span><span class="ch">\n</span><span class="st"> CVT (n=98) </span><span class="ch">\n</span><span class="st"> (VTF n=18623)'</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>node_label_4 <span class="op">=</span> <span class="st">'Exkl.: </span><span class="ch">\n</span><span class="st"> "Dubletter" (&gt;1 dx-kriterier uppfyllda) </span><span class="ch">\n</span><span class="st"> Icke-första VTF för patienten </span><span class="ch">\n</span><span class="st"> (n=871)'</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>node_label_5 <span class="op">=</span> <span class="st">"Inkl.: Transfer prim. IVA -&gt; tert. sjukh.:</span><span class="ch">\n</span><span class="st"> aSAH (n=1741) </span><span class="ch">\n</span><span class="st"> TBI (n=2273 </span><span class="ch">\n</span><span class="st"> ICH (n=1348) </span><span class="ch">\n</span><span class="st"> AIS (n=727) </span><span class="ch">\n</span><span class="st"> ABM (n=311) </span><span class="ch">\n</span><span class="st"> SEP (n=64) </span><span class="ch">\n</span><span class="st"> AVM (n=29) </span><span class="ch">\n</span><span class="st"> ENC (n=57) </span><span class="ch">\n</span><span class="st"> CVT (n=40) </span><span class="ch">\n</span><span class="st"> (VTF n=6590) </span><span class="ch">\n</span><span class="st"> (Patient n=6590)"</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>node_label_6 <span class="op">=</span> <span class="st">'Exkl.: </span><span class="ch">\n</span><span class="st"> "Icke-transfers" </span><span class="ch">\n</span><span class="st"> (n=12033)'</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Create Digraph object</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>dot <span class="op">=</span> Digraph()</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Create subgraph for vertical nodes (1, 2, 3, 5)</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> dot.subgraph() <span class="im">as</span> s:</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>    s.attr(rank<span class="op">=</span><span class="st">'same'</span>)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>    s.node(<span class="st">'node1'</span>, label<span class="op">=</span>node_label_1, shape<span class="op">=</span><span class="st">'box'</span>, style<span class="op">=</span><span class="st">'filled'</span>, fillcolor<span class="op">=</span><span class="st">'white'</span>)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>    s.node(<span class="st">'node2'</span>, label<span class="op">=</span>node_label_2, shape<span class="op">=</span><span class="st">'box'</span>, style<span class="op">=</span><span class="st">'filled'</span>, fillcolor<span class="op">=</span><span class="st">'white'</span>)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>    s.node(<span class="st">'node3'</span>, label<span class="op">=</span>node_label_3, shape<span class="op">=</span><span class="st">'box'</span>, style<span class="op">=</span><span class="st">'filled'</span>, fillcolor<span class="op">=</span><span class="st">'white'</span>)</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>    s.node(<span class="st">'node5'</span>, label<span class="op">=</span>node_label_5, shape<span class="op">=</span><span class="st">'box'</span>, style<span class="op">=</span><span class="st">'filled'</span>, fillcolor<span class="op">=</span><span class="st">'green'</span>)</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Add nodes 4 and 6 directly to the right of nodes 2 and 3, respectively</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>dot.node(<span class="st">'node4'</span>, label<span class="op">=</span>node_label_4, shape<span class="op">=</span><span class="st">'box'</span>, style<span class="op">=</span><span class="st">'filled'</span>, fillcolor<span class="op">=</span><span class="st">'red'</span>)</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>dot.node(<span class="st">'node6'</span>, label<span class="op">=</span>node_label_6, shape<span class="op">=</span><span class="st">'box'</span>, style<span class="op">=</span><span class="st">'filled'</span>, fillcolor<span class="op">=</span><span class="st">'red'</span>)</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Connect nodes</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>dot.edge(<span class="st">'node1'</span>, <span class="st">'node2'</span>)</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>dot.edge(<span class="st">'node2'</span>, <span class="st">'node3'</span>)</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>dot.edge(<span class="st">'node2'</span>, <span class="st">'node4'</span>)</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>dot.edge(<span class="st">'node3'</span>, <span class="st">'node5'</span>)</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>dot.edge(<span class="st">'node3'</span>, <span class="st">'node6'</span>)</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the graph</span></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>dot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="1">
<p><img src="1-descriptive-statistics_files/figure-html/cell-2-output-1.svg" class="img-fluid"></p>
</div>
</div>
</section>
</section>
</section>
<section id="major-issues-to-respond-to" class="level2">
<h2 class="anchored" data-anchor-id="major-issues-to-respond-to">Major issues to respond to</h2>
<section id="limiting-selection-to-transfers-50-km" class="level3">
<h3 class="anchored" data-anchor-id="limiting-selection-to-transfers-50-km">Limiting selection to transfers &gt;50 km?</h3>
<p>Limiting to this subset will make the patient cohort and transfers more homogenous.</p>
</section>
<section id="limiting-selection-to-urgent-transfers-validity-of-sir-recordings-of-pre-transfer-status" class="level3">
<h3 class="anchored" data-anchor-id="limiting-selection-to-urgent-transfers-validity-of-sir-recordings-of-pre-transfer-status">Limiting selection to “urgent transfers”? (Validity of SIR recordings of pre-transfer status)</h3>
<p>A recurring problem will be to understand the state of the patient prior to transfers in primary ICU stays that are longer than a few hours. SAPS3 (admission status) contains, potentially, a lot of information. However, how long is this information relevant? For 1h? Yes. For 6 hours? Probably. 2 days into the ICU stay? Probably less so. The same goes for SIR-registered procedures: I have, based on personal experience, serious doubts about the precision of the timestamps for some procedures. Ventilation (invasive/non-invasive) might be better than other timestamps though.</p>
<p><em>Idea for solution: In the patient selection, limit to only patients that are being transferred within 12 or 24 hours of primary ICU admission. This will in part solve this issue. Also, it will probably shift the cohort to “patients undergoing urgent transfer…”.</em></p>
</section>
<section id="rls-85-vs-gcs" class="level3">
<h3 class="anchored" data-anchor-id="rls-85-vs-gcs">RLS-85 vs GCS</h3>
<p>The majority of recorded concioussness level assessments in SIR are based on RLS-85 (&gt;70%), the rest are GCS. While potentially destroying some information it is tempting to make a translation between the two systems. A possible approach is to use the same “translation” as SIR does (https://www.icuregswe.org/globalassets/riktlinjer/riskjustering2.pdf, page 9), essentially transforming the assesment to a score with 5 levels.</p>
</section>
<section id="re-transfers" class="level3">
<h3 class="anchored" data-anchor-id="re-transfers">Re-transfers</h3>
<p>Is it really reasonable to only include the first transfer for each patient?</p>
</section>
</section>
<section id="descriptive-statistics" class="level2">
<h2 class="anchored" data-anchor-id="descriptive-statistics">Descriptive statistics</h2>
<section id="cohort-description" class="level3">
<h3 class="anchored" data-anchor-id="cohort-description">Cohort description</h3>
<table class="table">
<colgroup>
<col style="width: 12%">
<col style="width: 33%">
<col style="width: 19%">
<col style="width: 13%">
<col style="width: 13%">
<col style="width: 7%">
</colgroup>
<thead>
<tr class="header">
<th><strong>Cohort Description</strong></th>
<th><strong>Definition</strong></th>
<th><strong>Statistic</strong></th>
<th><strong>Problems</strong></th>
<th><strong>Alternatives</strong></th>
<th><strong>Missing Data</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Age distribution</strong></td>
<td>Age from PAR</td>
<td>Median age, IQR, and boxplot</td>
<td>-</td>
<td>-</td>
<td>None expected</td>
</tr>
<tr class="even">
<td><strong>Sex distribution</strong></td>
<td>Sex from PAR</td>
<td>Number of female patients and proportion of total cohort</td>
<td>-</td>
<td>-</td>
<td>None expected</td>
</tr>
<tr class="odd">
<td><strong>Diagnosis groups</strong></td>
<td>Diagnostic group based on PAR diagnosis at tertiary center</td>
<td>Number of patients per group and proportion of total cohort</td>
<td>-</td>
<td>-</td>
<td>None expected</td>
</tr>
<tr class="even">
<td><strong>Comorbidities</strong></td>
<td>As per SAPS3</td>
<td>Number of patients and proportion</td>
<td>Not validated.</td>
<td>Include Ryan’s comorbidity script to capture more?</td>
<td>Describe proportion missing</td>
</tr>
<tr class="odd">
<td><strong>DNR orders before transport</strong></td>
<td>Any DNR order as per SIR</td>
<td>Number of patients and proportion</td>
<td>-</td>
<td>-</td>
<td>Describe proportion missing</td>
</tr>
<tr class="even">
<td><strong>Consciousness level before transport</strong></td>
<td>RLS85, GCS, and GCSm as per SAPS. Assisted ventilation (excluding “noninvasive ventilation”) as per the definition. Unconsciousness defined as RLS &lt;3, GCS &lt;9, or intubated.</td>
<td>Median, IQR values for RLS85, GCS, GCSm. Number of patients and proportion of unconscious patients</td>
<td>Problems with temporality.</td>
<td>No dichotomization of unconsciousness as this might destroy data.</td>
<td>Describe proportion missing</td>
</tr>
<tr class="odd">
<td><strong>Assisted ventilation before transport</strong></td>
<td>Any of the SIR procedure codes for “Invasiv ventilation”, “Noninvasiv ventilation”, “Intubation”, “SAPS3 förekomst av mekanisk ventilation”</td>
<td>Numbers of patients and proportion</td>
<td>The latter might become a problem in cases where the patient is transported days into their ICU stay, but without a registered procedure “Invasiv ventilation”. Could that mean that the patient was extubated? Not all hospitals are reporting procedures.</td>
<td>-</td>
<td>Describe proportion missing</td>
</tr>
<tr class="even">
<td><strong>Respiratory instability before transport</strong></td>
<td>(1) SAPS3 Reasons(s) for admission, ANY respiratory reason; OR (2) PFI &lt;= 26.6 kPa (same level as moderate ARDS dx criteria)</td>
<td>Number of patients and proportion</td>
<td>Temporal component</td>
<td>-</td>
<td>Describe proportion missing</td>
</tr>
<tr class="odd">
<td><strong>Hemodynamic instability before transport</strong></td>
<td>(1) SAPS3 Lowest within 1h of admission SBP &lt;80 mmHg; OR (2) SAPS3 Reason(s) for admission, ANY shock reason; OR (3) SIR DX with ICD10 code I46.X (cardiac arrest), I47.X (ventricular tachycardia), I50.1 (left-sided HF), I50.2 (right-sided HF)</td>
<td>Number of patients and proportion</td>
<td>Temporal component</td>
<td>-</td>
<td>Describe proportion missing</td>
</tr>
<tr class="even">
<td><strong>General acute severity of illness (SAPS3)</strong></td>
<td>Total SAPS 3 score</td>
<td>Median and IQR</td>
<td>-</td>
<td>Split the SAPS 3 components</td>
<td>Describe proportion missing</td>
</tr>
<tr class="odd">
<td><strong>Time of transport</strong></td>
<td>Weekday 8-17, Weekend 8-17, After hours 17-08</td>
<td>Number of patients and proportions</td>
<td>-</td>
<td>-</td>
<td>None expected</td>
</tr>
<tr class="even">
<td><strong>Urgency of transport:</strong></td>
<td>Time spent at sending ICU (VardTidMinuter)</td>
<td>Median, IQR, and boxplot</td>
<td>-</td>
<td>-</td>
<td>None expected</td>
</tr>
<tr class="odd">
<td><strong>Mortality: crude</strong></td>
<td>(1) In-hospital mortality at tertiary center (date of death within discharge date + 1); (2) 30-day mortality; (3) 90-day mortality; (4) 365-day mortality</td>
<td>Numbers and proportions, per diagnostic group and total</td>
<td>-</td>
<td>-</td>
<td>None expected</td>
</tr>
</tbody>
</table>
</section>
<section id="sending-hospital-description" class="level3">
<h3 class="anchored" data-anchor-id="sending-hospital-description">Sending Hospital Description</h3>
<table class="table">
<colgroup>
<col style="width: 13%">
<col style="width: 25%">
<col style="width: 22%">
<col style="width: 18%">
<col style="width: 19%">
</colgroup>
<thead>
<tr class="header">
<th><strong>Transfer Information</strong></th>
<th><strong>Definition</strong></th>
<th><strong>Statistic</strong></th>
<th><strong>Problems</strong></th>
<th><strong>Alternatives</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Number of Transfers per center and year</strong></td>
<td>Number of transfers</td>
<td>Median number of transfers per year, IQR</td>
<td>(1) Some hospitals do not send data to SIR the whole period, the statistic needs to take this into consideration; (2) The actual number of transfers is higher, even in our dataset. A re-transfer is still a transfer!</td>
<td>Redo the whole process of selecting out patients. (I.e. don’t drop all transfers but the first?)</td>
</tr>
<tr class="even">
<td><strong>Distance of transport:</strong></td>
<td>Geodesic distance from Primary ICU to tertiary hospital. Also, per receiving center.</td>
<td>Violinplot. Median value, IQR.</td>
<td>Not actual traveled distance unless transferred by rotary-wing. On the other hand, distance is a proxy for other things (eg. time) to begin with.</td>
<td>-</td>
</tr>
<tr class="odd">
<td><strong>Mapping of transfers</strong></td>
<td>A map to show the direction of transfers, the relative volume of transfers, the geography of transfers.</td>
<td>A map of Sweden showing “connections” between sending and receiving hospitals.</td>
<td>The map is static but contains lots of information.</td>
<td>In addition to a static graph, as a supplement, publish an online dynamic plotly graph?</td>
</tr>
</tbody>
</table>
</section>
<section id="receiving-hospital-description" class="level3">
<h3 class="anchored" data-anchor-id="receiving-hospital-description">Receiving Hospital Description</h3>
<table class="table">
<colgroup>
<col style="width: 17%">
<col style="width: 13%">
<col style="width: 19%">
<col style="width: 24%">
<col style="width: 26%">
</colgroup>
<thead>
<tr class="header">
<th><strong>Transfer Information</strong></th>
<th><strong>Definition</strong></th>
<th><strong>Statistic</strong></th>
<th><strong>Problems</strong></th>
<th><strong>Alternatives</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Number of Transfers per center and year</strong></td>
<td>Number of transfers</td>
<td>Median number of transfers per year, IQR</td>
<td>(1) Some hospitals do not send data to SIR the whole period, the statistic needs to take this into consideration; (2) The actual number of transfers is higher, even in our dataset. A re-transfer is still a transfer!</td>
<td>Redo the whole process of selecting out patients. (I.e. don’t drop all transfers but the first?)</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="statistical-inference" class="level2">
<h2 class="anchored" data-anchor-id="statistical-inference">Statistical Inference</h2>
<section id="are-there-differences-in-outcomes-per-tertiary-center-in-these-transferred-patients" class="level3">
<h3 class="anchored" data-anchor-id="are-there-differences-in-outcomes-per-tertiary-center-in-these-transferred-patients">Are there differences in outcomes per tertiary center in these transferred patients?</h3>
<p>Rationale: Not sure this should stay. This is a tricky question. At first glance, one could think that we’re trying to answer the question “which center is the best performing center?”.</p>
<p>Defintions: (1) Outcome as death within 30 days, 365 days or some sort of marker of functional outcome; (2) Exposure the tertiary center the patient was sent to. Adjustment set: (3) One of the 5 levels of concioussness in SAPS3 (GCS/RLS transformed as per SIR suggestion); (4) Mechanically ventilated, a marker for disease severity; (5) Comorbidities (Elixhauser or a sum of SAPS 3 comorbidites?); (6) Dx group; (7) Age, standardized</p>
<p>Model: In short, a GLM where the parameter of interest is the coefficient <span class="math inline">\(\beta_{center[i]}\)</span> for the receiving tertiary center <span class="math inline">\(i\)</span>. The suggested model takes in to account the ordinal nature of the conciousness level score (i.e.&nbsp;constraining it model so that more severe levels of conciousness cannot lead to a predicted better outcome than better levels). Also, it is assumed that Elixhauser Comorbidity Index, or another score with many levels that can be approximated to be continuous, is used for comorbidity scoring.</p>
<p><span class="math inline">\(D_{i} \sim \text{Binomial}(1, p_{i})\)</span></p>
<p><span class="math inline">\(\text{logit}(p_{i}) = \beta_{intercept} + \beta_{center[i]} + \beta_{dx[j]} + \beta_{conciousness} \sum_{k=0}^{E_{i}-1} \delta_{k} + \beta_{mechvent[l]} + \beta_{comorb} * Comorb_{std} + \beta_{age} * Age_{std}\)</span></p>
<p><span class="math inline">\(\beta_{intercept} \sim \text{Normal}(0,1)\)</span></p>
<p><span class="math inline">\(\beta_{center} \sim \text{Normal}(0,1) \space (6×1)\)</span></p>
<p><span class="math inline">\(i = \text{idx of center}\)</span></p>
<p><span class="math inline">\(\beta_{dx[j]} \text{Normal}(0,1) \space (9×1)\)</span></p>
<p><span class="math inline">\(j = \text{idx of dx}\)</span></p>
<p><span class="math inline">\(\beta_{conciousness} \sim \text{Normal}(0,1)\)</span></p>
<p><span class="math inline">\(\delta_{k} \sim \text{Dirichlet}(\alpha)\)</span></p>
<p><span class="math inline">\(\alpha = (2,2,2,2)\)</span></p>
<p><span class="math inline">\(\beta_{mechvent} \sim \text{Normal}(0,1) \space (2×1)\)</span></p>
<p><span class="math inline">\(l = \text{idx of mechvent}\)</span></p>
<p><span class="math inline">\(\beta_{comorb} \sim N(0,1)\)</span></p>
<p><span class="math inline">\(\beta_{age} \sim N(0,1)\)</span></p>
<p>Missing data handling: First, let’s find out how big the problem is.</p>
<p>Mesaurement error handling: Age and center probably don’t have measurement error. The variables mechanical ventilation, conciousness level and comrobidity score could be turned into random variables (bernoulli, binomial and normal respectively)</p>
<p>Limitations: The interpretation of the parameter of interest will have to be made with great caution. Potential confounders not adjusted for is the quality of care at the sending hospital, the quality of the care during transfer, the diffuculties of the transfer that are not modifiable (i.e.&nbsp;distance, geography), the process with which patients are accepted (not accounted for in age, comorbidites and level of conciousness). All in all, it’s a bit difficult to tell what is actually modeled here.</p>
</section>
<section id="what-are-the-predictors-for-short-term-mortality-in-transferred-patients" class="level3">
<h3 class="anchored" data-anchor-id="what-are-the-predictors-for-short-term-mortality-in-transferred-patients">What are the predictors for short term mortality in transferred patients?</h3>
<p>Rationale: This predictive model will help us understand if there are patients at high risk of a bad outcome in short term. While this would not suggest that this outcome is modifiable, the findings could possibly hypothesis generating.</p>
<p>Defintions: Short term mortality defined as death within 7 days (or just as death in a Cox PH model)</p>
<p>Model: n.d.</p>
<p>Limitations: Inherently, this becomes a model of mortality in the neuro ICU. Unless you find matched non-transported patients or can link the risk factors to some complication IN TRANSIT of coursee. I think that the question.</p>
</section>
<section id="what-is-the-effect-of-transfer-distance-on-outcome" class="level3">
<h3 class="anchored" data-anchor-id="what-is-the-effect-of-transfer-distance-on-outcome">What is the effect of transfer distance on outcome?</h3>
<p>Rationale: The only way this could be relevant from a causal point of view is if we are willing to make the assumption that, all else being equal, it does not matter for outcome which primary ICU the patient is admitted to. Consider a simple case, that is somewhat similar to a multilevel approach: there is only one tertiary center and three sending hospitals A, B and C. A, B and C are 90, 160 and 200 km from the university hospital, respectively. Let’s adjust for severity of illness, age etc. Now, if we believe that there is a difference in quality of the acute care in hospitals A, B and C, we would need to adjust for this as well. The problem is that in our causal model, we are considering distance to be the treatment. Since the treatment within these levels of covariate combinations will always be the same (i.e.&nbsp;the distances are fixed), <em>the positivity assumption is violated. Thus we cannot estimate a causal effect.</em></p>
<p>Alternative 1: Model outcome in a multilevel setting (tertiary hospitals being a level) adjusted for SOI, comorbidities, demographics, diagnosis and distance. Interpret the distance coefficient with great caution, do not use causal speak.</p>
<p>Alternative 2: Model outcome in a multilevel setting (tertiary hospitals being a level) adjusted for SOI, comorbidities, demographics, diagnosis and sending hospital. Describe the predictive value of sending hospitals. Again, with great caution.</p>
<p>Defintions: -</p>
<p>Model: n.d.</p>
<p>Limitations: Puh… see above.</p>
</section>
<section id="what-is-the-effect-of-season-and-weather-flight-rules-at-time-of-primary-icu-discharge-on-outcome-in-patients-transferred-from-hospitals-utilizing-rotary-wing-transports" class="level3">
<h3 class="anchored" data-anchor-id="what-is-the-effect-of-season-and-weather-flight-rules-at-time-of-primary-icu-discharge-on-outcome-in-patients-transferred-from-hospitals-utilizing-rotary-wing-transports">What is the effect of season and weather (flight rules at time of primary ICU discharge) on outcome in patients transferred from hospitals utilizing rotary wing transports?</h3>
<p>Rationale: See the DAG here https://dagitty.net/dags.html?id=nTQ8qQKV</p>
<p>A subset of the sending hospitals are using rotary wing transports (eg. Falun, Mora, Karlstad, Hudiksvall, Visby, Skövde…). Some are not (Borås, Helsingborg). Some hospitals are more tricky to categorize. Rotary wing transports can be unavailable due to weather. One of the main deciding factors are weather minimums, mainly the visibility. Visibility can be categorized. Typically, in LIFR (Low Instrument Flight Rules ) and IFR (Instrument Flight Rules), helicopters will not be able to fly (with exceptions that are not relevant here). Whereas in MVFR (Marginal Visual Flight Rules) and VFR (Visual Flight Rules) chances are much higher that weather minimums are fulfilled. Daytime/nighttime also affects the rules. There is a clear seasonality in weather conditions, for example, at Östersund airport, daytime VFR conditions are fulfilled during, on average, 85% of the time in May and only 45% in November (https://metar-taf.com/stats/ESNZ).</p>
<p>Defintions: WIP…</p>
<p>Model: WIP…</p>
<p>Essentially a partial pooling model, where sending hospital is a level. Sending hospitals that typically send to the same tertiary center should be partially pooled.</p>
<p>The meat of the model is the weather parameter, that could be ordered categorical and look something like:</p>
<p><span class="math inline">\(\beta_{FR} \sim \text{Normal}(0,1)\)</span></p>
<p><span class="math inline">\(\delta_{j} \sim \text{Dirichlet}(\alpha)\)</span></p>
<p><span class="math inline">\(\alpha = (2,2,2)\)</span></p>
<p>Also, variable “DX_GROUP” (categorical) and probably some markers for demography, comorbidities and acute SOI.</p>
<p>Limitations: WIP</p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>